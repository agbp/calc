(()=>{"use strict";var t;function i(t){var i=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return i?decodeURIComponent(i[1]):void 0}!function(t){t[t.plus=10]="plus",t[t.minus=20]="minus",t[t.multiply=30]="multiply",t[t.divide=40]="divide",t[t.percent=50]="percent",t[t.equal=60]="equal",t[t.pow=70]="pow",t[t.sqrt=80]="sqrt",t[t.sin=90]="sin",t[t.cos=100]="cos",t[t.asin=110]="asin",t[t.acos=120]="acos",t[t.log=130]="log",t[t.oneDivX=140]="oneDivX"}(t||(t={})),{inputElement:document.getElementById("calc_input"),historyDiv:document.getElementById("calc_history"),scientificDiv:document.getElementById("calc_scientific"),historyList:document.getElementById("calc_history_list"),historyListData:[],stack:[],waiting4NewNumber:!1,historyOpened:!1,scientificOpened:!1,operations:[],clearInput:function(){this.inputElement.value="0",this.stack.length=0},getHistoryList:function(){var t=this,n=i("historyList");n&&(this.historyListData=JSON.parse(n),this.historyListData.forEach((function(i){t.addToHistoryList.call(t,i,!0)})))},saveHistoryList:function(){console.log(JSON.stringify(this.historyListData)),document.cookie="historyList=".concat(JSON.stringify(this.historyListData))},addToHistoryList:function(t,i){void 0===i&&(i=!1);var n=document.createElement("li");n.innerText=t,this.historyList.appendChild(n),i||(this.historyListData.push(t),this.saveHistoryList())},addDigitOrOperation:function(i){if(i in t){var n=this.operations.find((function(t){return t.id===i})),e=NaN;if(this.stack.length){for(var s=this.stack.pop(),a=this.operations.find((function(t){return t.id===s})),o=[],r=1;r<a.arity;r++)o.push(this.stack.pop());o.push(Number(this.inputElement.value)),e=a.action.apply(null,o),this.inputElement.value=String(e),this.addToHistoryList(String(o[0])+a.representation+String(o[1])+"="+this.inputElement.value)}else e=Number(this.inputElement.value);1===n.arity?(e=n.action(Number(this.inputElement.value)),this.addToHistoryList(n.representation+"("+this.inputElement.value+")="+String(e)),this.inputElement.value=String(e)):n.arity>1&&(this.stack.push(e),this.stack.push(i)),this.waiting4NewNumber=!0}else{if(this.waiting4NewNumber&&"\b"!==i&&(this.inputElement.value="",this.waiting4NewNumber=!1),"\b"===i)return this.inputElement.value=this.inputElement.value.slice(0,-1),""===this.inputElement.value&&(this.inputElement.value="0"),void(this.waiting4NewNumber=!1);if("."===i){if(-1!==this.inputElement.value.indexOf("."))return;0===Number(this.inputElement.value)&&(this.inputElement.value="0")}else{if("0"===i&&"0"===this.inputElement.value)return;-1===this.inputElement.value.indexOf(".")&&0===Number(this.inputElement.value)&&(this.inputElement.value="")}this.inputElement.value=this.inputElement.value+i}},changeHistoryDisplay:function(){this.historyOpened=!this.historyOpened,this.historyDiv.classList.toggle("hidden"),this.historyDiv.classList.toggle("shown"),document.cookie="historyOpened=".concat(this.historyOpened)},changeScientificDisplay:function(){this.scientificOpened=!this.scientificOpened,this.scientificDiv.classList.toggle("hidden"),this.scientificDiv.classList.toggle("shown"),document.cookie="scientificOpened=".concat(this.scientificOpened)},init:function(){var n=this;document.getElementById("btn_history").addEventListener("click",this.changeHistoryDisplay.bind(this)),document.getElementById("btn_scientific").addEventListener("click",this.changeScientificDisplay.bind(this)),this.initOperations(),this.clearInput(),this.inputElement.addEventListener("input",(function(t){var i=t.target;console.log("value = ",i.value),""!==i.value||n.clearInput()})),this.addActionToButtonClick("btn_clear",this.clearInput.bind(this)),this.addEventsToDigitButtons(),this.addInputToButtonClick("btn_pt","."),this.addInputToButtonClick("btn_backspace","\b"),document.addEventListener("keydown",(function(i){switch(console.log("key pressed : ",i.key," key code = ",i.keyCode),i.key){case".":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"0":n.addDigitOrOperation(i.key);break;case"+":n.addDigitOrOperation(t.plus);break;case"-":n.addDigitOrOperation(t.minus);break;case"*":n.addDigitOrOperation(t.multiply);break;case"/":case"/":n.addDigitOrOperation(t.divide);break;case"=":n.addDigitOrOperation(t.equal);break;case"%":n.addDigitOrOperation(t.percent);break;default:switch(i.keyCode){case 67:n.clearInput();break;case 8:n.addDigitOrOperation("\b");break;case 72:n.changeHistoryDisplay();break;case 83:n.changeScientificDisplay()}}}));var e=i("historyOpened");void 0!==e&&String(this.historyOpened)!==e&&this.changeHistoryDisplay();var s=i("scientificOpened");void 0!==s&&String(this.scientificOpened)!==s&&this.changeScientificDisplay(),this.getHistoryList()},addActionToButtonClick:function(t,i){document.getElementById(t).addEventListener("click",i)},addInputToButtonClick:function(t,i){var n=this;this.addActionToButtonClick(t,(function(){n.addDigitOrOperation(i)}))},addEventsToDigitButtons:function(){for(var t=0;t<10;t++)this.addInputToButtonClick("btn_".concat(t),String(t))},initOperations:function(){var i=this;this.operations.push({id:t.equal,bittonId:"btn_equal",arity:0,action:function(t,i){return NaN},representation:"="}),this.operations.push({id:t.plus,bittonId:"btn_plus",arity:2,action:function(t,i){return t+i},representation:"+"}),this.operations.push({id:t.minus,bittonId:"btn_minus",arity:2,action:function(t,i){return t-i},representation:"-"}),this.operations.push({id:t.multiply,bittonId:"btn_multiply",arity:2,action:function(t,i){return t*i},representation:"×"}),this.operations.push({id:t.divide,bittonId:"btn_divide",arity:2,action:function(t,i){return t/i},representation:"/"}),this.operations.push({id:t.pow,bittonId:"btn_pow",arity:2,action:function(t,i){return Math.pow(t,i)},representation:"^"}),this.operations.push({id:t.sqrt,bittonId:"btn_sqrt",arity:1,action:function(t){return Math.sqrt(t)},representation:"√"}),this.operations.push({id:t.percent,bittonId:"btn_percent",arity:1,action:function(t){return t/100},representation:"%"}),this.operations.push({id:t.sin,bittonId:"btn_sin",arity:1,action:function(t){return Math.sin(t)},representation:"sin"}),this.operations.push({id:t.cos,bittonId:"btn_cos",arity:1,action:function(t){return Math.cos(t)},representation:"cos"}),this.operations.push({id:t.asin,bittonId:"btn_asin",arity:1,action:function(t){return Math.asin(t)},representation:"asin"}),this.operations.push({id:t.acos,bittonId:"btn_acos",arity:1,action:function(t){return Math.acos(t)},representation:"acos"}),this.operations.push({id:t.log,bittonId:"btn_log",arity:1,action:function(t){return Math.log(t)},representation:"log"}),this.operations.push({id:t.oneDivX,bittonId:"btn_oneDivX",arity:1,action:function(t){return 1/t},representation:"1/"}),this.operations.forEach((function(t){i.addInputToButtonClick(t.bittonId,t.id)}))}}.init()})();